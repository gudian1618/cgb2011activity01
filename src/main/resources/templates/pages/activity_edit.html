<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">
        ul li {
            list-style-type: none
        }
    </style>
</head>
<body>
<h1>The Activity Edit Page</h1>
<!--<form action="/activity/doSaveActivity" method="post">-->
<!--    <ul>-->
<!--        <li><input type="hidden" name="id" th:value="${act.id}"></li>-->
<!--        <li>标题</li>-->
<!--        <li><input type="text" name="title" th:value="${act.title}"></li>-->
<!--        <li>类型</li>-->
<!--        <li><input type="text" name="category" th:value="${act.category}"></li>-->
<!--        <li>开始时间</li>-->
<!--        <li><input type="text" name="startTime" th:value="${#temporals.format(act.startTime, 'yyyy/MM/dd HH:mm:ss')}"></li>-->
<!--        <li>结束时间</li>-->
<!--        <li><input type="text" name="endTime" th:value="${#temporals.format(act.endTime, 'yyyy/MM/dd HH:mm:ss')}"></li>-->
<!--        <li>备注</li>-->
<!--        &lt;!&ndash;<li><textarea rows="5" cols="30" name="remark" >[[${act.remark}]]</textarea></li>&ndash;&gt;-->
<!--        <li><textarea rows="5" cols="30" name="remark" th:text="${act.remark}"></textarea></li>-->
<!--        <li>提交<input type="submit" value="save"></li>-->
<!--    </ul>-->
<!--</form>-->
<form enctype="application/x-www-form-urlencoded">
    <ul>
        <!--<li><input type="hidden" name="id" ></li>-->
        <li>标题</li>
        <li><input type="text" id="titleId" name="title"></li>
        <li>类型</li>
        <li><input type="text" id="categoryId" name="category"></li>
        <li>开始时间</li>
        <li><input type="text" id="startTimeId" name="startTime"></li>
        <li>结束时间</li>
        <li><input type="text" id="endTimeId" name="endTime"></li>
        <li>备注</li>
        <!--<li><textarea rows="5" cols="30" name="remark" >[[${act.remark}]]</textarea></li>-->
        <li><textarea rows="5" cols="30" id="remarkId" name="remark"></textarea></li>
        <li><input type="button" value="save" onclick="doSaveActivity()"></li>
    </ul>
</form>
<script type="text/javascript">
    function $(id) {
        return document.getElementById(id);
    }

    function doAjaxPost(url, params, callback) {
        // debugger
        // 1.创建ajax异步请求对象(这也是ajax技术应用的入口对象)
        var xhr = new XMLHttpRequest();
        // 2.设置请求,响应过程的状态监听(通过回调函数处理状态变化)
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // 4 表示通信结束
                // 200 表示服务端响应ok
                // 服务端响应的结果会传递给XHR对象,我们可以借助response获取响应结果
                // console.log("response text", xhr.responseText)
                // xhr.responseText用于获取服务端的响应结果
                callback(xhr.responseText);
            }
        };
        // 3.创建或打开与服务端的链接(设置同步或异步)
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        // 4.发送异步post请求
        xhr.send(params);
    }

    function doSaveActivity() {
        // debugger
        // 1.定义请求参数
        var title = $("titleId").value;
        var category = $("categoryId").value;
        var startTime = $("startTimeId").value;
        var endTime = $("endTimeId").value;
        var remark = $("remarkId").value;
        var params = "title=" + title + "&category=" + category + "&startTime=" + startTime + "&endTime=" + endTime + "&remark=" + remark;
        // 2.定义请求的url
        var url = "doSaveActivity";
        // 3.发送异步请求
        doAjaxPost(url, params, function (result) {
            alert(result);
            location.href = "activity_list";
        });
    }

</script>
</body>
</html>
